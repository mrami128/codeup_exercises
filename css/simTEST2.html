<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <style>
        .container {
            width: 450px;
            border: 1px solid red;
            margin-left: 25px;
            padding-left: 25px;
        }

        .controlPanel {
            width: 400px;
            text-align: center;
            border: 1px solid yellow;
        }

        #gameTitle {
            font-size: 40px;
        }

        #start {
            /*margin-left: 155px;*/
            height: 40px;
            width: 90px;
            background-color: lightgrey;
        }

        #hiScore {
            margin-left: 20px;
            margin-bottom: 20px;
            height: 40px;
            width: 90px;
            background-color: lightgrey;
        }

        .box-container { /*THIS is main box-not body-not h1    also opt/sht+up/ dwn moves sel codelines  up or dwn*/
            width: 400px;
            height: 400px;
            border: 3px solid green;
        }

        .box { /*class for each indiv box red blue green  yellow below*/
            width: 90px;
            height: 90px;
            border: 2px solid black;
            margin-top: 60px;
            margin-bottom: 20px;
            margin-left: 50px;
            margin-right: 20px;
            padding: 10px;
            float: left; /* float left gets all the divs to line up sideways until contain full then moves downrow */
            font-size: 14px;
        }

        #red1 {
            background-color: red;
        }

        #green2 {
            background-color: green;
        }

        #blue3 {
            background-color: blue; /* ====clear will move the green box down to nex row--OR can use nth child with pseudo: indicator:*/
            clear: left; /*  .box:nth-child(3), .box:nth-child(5) { clear:left; } */
        }

        #yellow4 {
            background-color: #ffc455;
        }
    </style>

</head>
<body>


<div class="container">

    <div class="controlPanel">
        <h1 id="gameTitle"> Simon Game </h1>

        <br>
        <h3 id="level">Watch pattern below. <br>attempt to match that pattern</h3>


        <button id="start">Start Game</button>
        <button id="hiScore">Hi Score</button>
    </div>

    <div class="box-container">
        <div id="red1" class="box" data-num="1"> red1</div>
        <div id="green2" class="box" data-num="2"> green2</div>
        <div id="blue3" class="box" data-num="3"> blue3</div>
        <div id="yellow4" class="box" data-num="4"> yellow4</div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-2.2.4.js"
        integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI="
        crossorigin="anonymous"></script>


<script>  // ===============Jquery =================

$(document).ready(function () {
    "use strict";


// ======= Variable List ===================

    var simonArr = [];
    var marcArr = [];
    var level = 0;
    var newNum = 0;

// ======= function list ===================

    function youWin() {
        console.log('this is the you Win function')
    };

    function youLose() {
        start();
        console.log('this is the you lose function')
    };

    function flasher(element) {
        $(element)
            .animate({opacity: .10}, 800)
            .animate({opacity: 1}, 800);
    } //this is flash end brace

    function getNextNum() {

        var newNum = Math.floor((Math.random() * 4) + 1);

        simonArr.push(newNum);  //==== push this new number onto end of simonArr
    }

    function resetGame() {
        simonArr = [];
        marcArr = [];
        level = 0;
        nextRound();
    }

// ===== control panel button clicks ==============

    $('#hiScore').click(function () {
        alert('Simon has the Hi score');
        youLose();
    });

    function start() {
        $('#start').on('click', function () {
            resetGame();
            $('#start').off('click');
        });
    }

    function nextRound() {

        level++;   //if new game then level goes from 0to1.

        if (level >= 21) {

            youWin();

        } else {

            $('#level').html('Level: ' + level);

            getNextNum();     // get next random number


            blinkAction();    // blink  the code of simonArr

            // activate the links and  allow  me to click the buttons into marcArr

            // update the marcArr

            //compare my click actions in marcArr to simonArr


            // if good call nextRound()
            // if nogood call youLose()

        }  // else end brace
    }  // end of nextRound() brace


// ==== simonArr info =====
//
//        console.log("number at index:" + i + " is " + simonArr[i]);
//        console.log('  simonArr consist of these numbers:' + simonArr);
//        console.log('    length is: ' + simonArr.length);


    //====== user clicking action =============

    function userInput() {
        var i = 0;
        $('.box').on('click', function () {         // turn on the click listener

            var btnValue = $(this).attr('data-num');

            if (btnValue == simonArr[i]) {          // compare the user clicks to each simonArr element

                if (i == simonArr.length - 1) {
                    nextRound();
                    console.log('You Completed level' + level);
                    $('.box').off('click');         // turn off the click listener while game is presenting the simon array

                } else {
                    i++;                            // cycle back to top for next user click
                }
            } else {                     // if user doesnt match simonArr-- turn off click and call youLose()
                $('.box').off('click');
                youLose();
            }
        });
    }

// === Light up buttons function as switch case ===== set some delaytime  and then light the button for user.

    function blinkAction() {
        var i = 0;
        var intervalId = setInterval(function () {
            switch (simonArr[i]) {

                case 1:
                    console.log("activate red1");
                    flasher('#red1');
                    break;

                case 2:
                    console.log("activate green2 ");
                    flasher('#green2');
                    break;

                case 3:
                    console.log("activate blue3 ");
                    flasher('#blue3');
                    break;

                case 4:
                    console.log("activate yellow4 ");
                    flasher('#yellow4');
                    break;

                default:
                    youLose();
                    console.log("SYSTEM ERROR game over function");
            }  //end of switch cases
            if (i >= simonArr.length - 1) {
                userInput();
                clearInterval(intervalId);
            } else {
                i++;
            }
        }, 1800);
    } //end of blink action
    start();

}); // this is end of iffe
</script>

</body>
</html>